<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard | Thinkr</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Space+Grotesk:wght@500;600;700&family=Michroma&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.3.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0/dist/chartjs-plugin-datalabels.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/progressbar.js"></script>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div id="loader">
        <div class="loader-glass">
            <img src="logo1.png" alt="Thinkr Logo" class="loader-logo" />
        </div>
    </div>

    <div id="dataForm"></div>

    <header>
        <div class="header-left">
            <div class="logo-container">
                <img src="logo1.png" alt="Thinkr Logo" class="logo">
            </div>
            <div id="greeting">Bine ai venit!</div>
        </div>
        <nav class="header-nav">
            <a href="/plans/personalisedPlans.html"><button class="nav-btn">PlanneR</button></a>
            <a href="/learning/styles.html"><button class="nav-btn">Test stil învățare</button></a>
            <a href="/tests/tests.html"><button class="nav-btn">Generare teste</button></a>
            <a href="/index.html"><button class="nav-btn">Acasa</button></a>
            <a href="/articles/articole.html"><button class="nav-btn">Articole</button></a>
            <button id="logoutBtn">Logout</button>
        </nav>
    </header>

    <div class="container">
        <section class="dashboard-section fade-in">
            <div class="section-header">
                <h2>Progresul tău</h2>
                <p class="section-description">Vizualizare de ansamblu a performanței tale academice.</p>
            </div>
            
            <div class="card-grid">
                <div class="card pulse main-stat">
                    <h3>Obiectiv zilnic</h3>
                    <div id="goalProgressContainer">
                        <div id="goalProgressBar"></div>
                        <div id="goalProgressLabel"></div>
                    </div>
                    <div id="progressText" class="status-badge"></div>
                    <div id="progressComparison" class="comparison-label"></div>
                    <form id="studyGoal" class="inline-form">
                        <input type="time" id="timeGoal" required />
                        <button type="submit">Setează target</button>
                    </form>
                </div>

                <div class="card chart-card">
                    <h3>Distribuția timpului</h3>
                    <div class="chart-wrapper">
                        <div id="distributionLoader" class="loader-container">
                            <svg width="24" height="24" viewBox="0 0 24 24" class="spin-icon">
                                <path d="M12,1A11,11,0,1,0,23,12,11,11,0,0,0,12,1Zm0,19a8,8,0,1,1,8-8A8,8,0,0,1,12,20Z" opacity=".25" fill="currentColor"/>
                                <path d="M12,4a8,8,0,0,1,7.89,6.7A1.53,1.53,0,0,0,21.38,12h0a1.5,1.5,0,0,0,1.48-1.75,11,11,0,0,0-21.72,0A1.5,1.5,0,0,0,2.62,12h0a1.53,1.53,0,0,0,1.49-1.3A8,8,0,0,1,12,4Z" fill="currentColor"/>
                            </svg>
                            <span>Se încarcă datele...</span>
                        </div>
                        <canvas id="timeDistributionChart"></canvas>
                    </div>
                </div>

                <div class="card chart-card">
                    <h3>Evoluția săptămânală</h3>
                    <div class="chart-wrapper">
                        <div id="weeklyLoader" class="loader-container">
                            <svg width="24" height="24" viewBox="0 0 24 24" class="spin-icon">
                                <path d="M12,1A11,11,0,1,0,23,12,11,11,0,0,0,12,1Zm0,19a8,8,0,1,1,8-8A8,8,0,0,1,12,20Z" opacity=".25" fill="currentColor"/>
                                <path d="M12,4a8,8,0,0,1,7.89,6.7A1.53,1.53,0,0,0,21.38,12h0a1.5,1.5,0,0,0,1.48-1.75,11,11,0,0,0-21.72,0A1.5,1.5,0,0,0,2.62,12h0a1.53,1.53,0,0,0,1.49-1.3A8,8,0,0,1,12,4Z" fill="currentColor"/>
                            </svg>
                            <span>Se încarcă datele...</span>
                        </div>
                        <canvas id="weeklyStudyChart"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <div class="two-column-layout">
            <section class="card fade-in">
                <h2>Activitatea ta</h2>
                <div class="stats-row">
                    <div class="stat-item">
                        <label>XP Total</label>
                        <button id="xp" class="gamified-btn"><img src="xp.png" class="xpImg" /> --</button>
                    </div>
                    <div class="stat-item">
                        <label>Streak</label>
                        <button id="streak" class="gamified-btn"><img src="streak.png" class="streakImg" /> --</button>
                    </div>
                </div>
                <p id="streakWarning"></p>
                
                <div class="heatmap-container">
                    <h3>Harta activității</h3>
                    <p class="small-desc">Activitatea din ultimele 12 săptămâni.</p>
                    <div id="studyHeatmap" class="heatmap-grid"></div>
                </div>

                <div class="badges-container">
                    <h3>Badge-uri obținute</h3>
                    <div class="badge-row">
                        <img src="badge/3.png" id="xp3" class="badge" title="3 XP">
                        <img src="badge/10.png" id="xp10" class="badge" title="10 XP">
                        <img src="badge/30.png" id="xp30" class="badge" title="30 XP">
                        <img src="badge/60.png" id="xp60" class="badge" title="60 XP">
                        <img src="badge/100.png" id="xp100" class="badge" title="100 XP">
                        <img src="badge/200.png" id="xp200" class="badge" title="200 XP">
                    </div>
                </div>
            </section>

            <section class="card fade-in">
                <h2>Productivitate</h2>
                
                <div class="tabs-container">
                    <div class="tool-group">
                        <h3>Sesiune de studiu</h3>
                        <form id="clock" class="study-session-form">
                            <div id="time">00:00:00</div>
                            <div class="input-stack">
                                <input list="titleSuggestions" id="sessionTitle" placeholder="Ce înveți astăzi?" required />
                                <datalist id="titleSuggestions"></datalist>
                                <input list="tagSuggestions" id="sessionTag" placeholder="Materia">
                                <datalist id="tagSuggestions"></datalist>
                                <input type="text" id="sessionDescription" placeholder="Detalii sesiune (opțional)" />
                            </div>
                            <div class="button-group">
                                <button id="startBtn" type="button" data-tooltip="Start">Start</button>
                                <button id="pauseBtn" type="button" data-tooltip="Pauză">Pauză</button>
                                <button type="submit" id="stopBtn" data-tooltip="Stop">Stop</button>
                                <button type="reset" id="resetBtn" data-tooltip="Reset">Resetează</button>
                            </div>
                        </form>
                    </div>

                    <div class="tool-group divider-top">
                        <h3>Pomodoro Timer</h3>
                        <form id="setPomodoro" class="pomodoro-config">
                            <div class="pomodoro-settings">
                                <div class="input-group">
                                    <label>Focus</label>
                                    <input type="number" id="minutes" placeholder="25" min="1" required />
                                </div>
                                <div class="input-group">
                                    <label>Pauză</label>
                                    <input type="number" id="breakMinutes" placeholder="5" min="1" required />
                                </div>
                                <div class="input-group">
                                    <label>Cicluri</label>
                                    <input type="number" id="cycles" placeholder="4" min="1" required />
                                </div>
                            </div>
                            <button type="submit" class="w-100">Configurează</button>
                        </form>
                        <div id="timePomodoro">00:00</div>
                        <div class="button-group">
                            <button id="startBtnPomodoro" type="button">Start</button>
                            <button id="pauseBtnPomodoro" type="button">Pauză</button>
                            <button id="stopBtnPomodoro" type="button">Stop</button>
                            <button id="resetBtnPomodoro" type="button">Reset</button>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <div class="two-column-layout">
            <section class="card fade-in">
                <h2>Adăugare manuală</h2>
                <form id="addSession" class="grid-form">
                    <div class="input-row">
                        <div class="input-group">
                            <label>Materia</label>
                            <input type="text" id="materie" placeholder="Ex: Biologie" required />
                        </div>
                        <div class="input-group">
                            <label>Titlu</label>
                            <input type="text" id="titlu" placeholder="Ex: Anatomie" required />
                        </div>
                    </div>
                    <label>Descriere</label>
                    <input type="text" id="descriere" placeholder="Ex: Capitolul 5" required />
                    <label>Durata (minute)</label>
                    <input type="number" id="durata" placeholder="Ex: 45" required />
                    <button type="submit">Salvează sesiunea</button>
                </form>
            </section>

            <section class="card fade-in">
                <h2>Istoric sesiuni</h2>
                <section id="displaySessions" class="scrollable-history"></section>
            </section>
        </div>

        <section class="card fade-in">
            <h2>AI Study Planner</h2>
            <div class="planner-layout">
                <form id="StudyPlanForm" class="planner-form">
                    <div class="input-row">
                        <div class="input-group">
                            <label>Clasa</label>
                            <input type="text" id="grade" placeholder="9" required />
                        </div>
                        <div class="input-group">
                            <label>Materia</label>
                            <input type="text" id="subject" placeholder="Matematică" required />
                        </div>
                    </div>
                    <label>Lecție / Subiect</label>
                    <input type="text" id="title" placeholder="Ex: Ecuații de gradul II" required />
                    <div class="input-row">
                        <div class="input-group">
                            <label>Zile</label>
                            <input type="number" id="days" placeholder="5" />
                        </div>
                        <div class="input-group">
                            <label>Ore/zi</label>
                            <input type="number" id="hours" placeholder="2" />
                        </div>
                    </div>
                    <button type="submit" class="w-100">Generează plan personalizat</button>
                </form>

                <div class="planner-output-container">
                    <div id="loading" class="loader-container">
                        <svg width="24" height="24" viewBox="0 0 24 24" class="spin-icon">
                            <path d="M12,1A11,11,0,1,0,23,12,11,11,0,0,0,12,1Zm0,19a8,8,0,1,1,8-8A8,8,0,0,1,12,20Z" opacity=".25" fill="currentColor"/>
                            <path d="M12,4a8,8,0,0,1,7.89,6.7A1.53,1.53,0,0,0,21.38,12h0a1.5,1.5,0,0,0,1.48-1.75,11,11,0,0,0-21.72,0A1.5,1.5,0,0,0,2.62,12h0a1.53,1.53,0,0,0,1.49-1.3A8,8,0,0,1,12,4Z" fill="currentColor"/>
                        </svg>
                        Se generează...
                    </div>
                    <section id="planOutput"></section>
                </div>
            </div>

            <div class="history-section divider-top">
                <h3>Istoric planuri</h3>
                <form id="searchForm" class="search-box">
                    <input type="text" id="searchPlan" placeholder="Caută în planurile salvate...">
                    <button type="submit">Caută</button>
                </form>
                <section id="displayHistory" class="history-grid"></section>
            </div>
        </section>
    </div>

    <button class="fab" id="mobileFab">+</button>

    <script>
        const style = document.createElement('style');
        style.textContent = `@keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }`;
        document.head.appendChild(style);
        document.getElementById('mobileFab').addEventListener('click', () => {
            document.querySelector('#clock').scrollIntoView({ behavior: 'smooth' });
        });
    </script>
    <script type="module" src="dashboard.js"></script>
</body>
</html>