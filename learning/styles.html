<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Teste</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Space+Grotesk:wght@500;600;700&display=swap" rel="stylesheet">
  <link href="/styles.css" rel="stylesheet">
  <style>
    :root {
      --bg-dark: #0f0f13;
      --bg-darker: #07070a;
      --bg-card: #1a1a24;
      --accent-blue: #4d8eff;
      --accent-purple: #8a63ff;
      --accent-cyan: #00e0ff;
      --text-primary: #f0f0f5;
      --text-secondary: #a0a0b0;
      --success: #2dd4a7;
      --warning: #ffb74d;
      --danger: #ff6b6b;
      --transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
      --shadow: 0 4px 20px rgba(0, 0, 0, 0.25);
      --shadow-hover: 0 8px 30px rgba(0, 0, 0, 0.35);
      --border-radius: 12px;
      --glass-effect: rgba(30, 30, 45, 0.6);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', sans-serif;
      background-color: var(--bg-dark);
      color: var(--text-primary);
      line-height: 1.6;
      min-height: 100vh;
      padding: 2rem;
      background-image: 
        radial-gradient(circle at 25% 25%, rgba(77, 142, 255, 0.15) 0%, transparent 50%),
        radial-gradient(circle at 75% 75%, rgba(138, 99, 255, 0.15) 0%, transparent 50%);
    }

    .container {
      max-width: 800px;
      margin: 0 auto;
    }

    .logo-container {
      text-align: center;
      margin-bottom: 2rem;
    }

    .logo {
      height: 60px;
      width: auto;
      margin-bottom: 1rem;
      transition: var(--transition);
    }

    h1, h2, h3, h4, h5, h6 {
      font-family: 'Space Grotesk', sans-serif;
      font-weight: 600;
      margin-bottom: 1.25rem;
      letter-spacing: -0.5px;
    }

    h1 { 
      font-size: 2.5rem; 
      color: var(--text-primary);
      text-align: center;
      margin-bottom: 2rem;
      position: relative;
    }

    h1:after {
      content: '';
      position: absolute;
      bottom: -10px;
      left: 50%;
      transform: translateX(-50%);
      width: 80px;
      height: 3px;
      background: linear-gradient(90deg, var(--accent-blue), var(--accent-purple));
      border-radius: 3px;
    }

    h2 {
      font-size: 1.5rem;
      color: var(--accent-cyan);
      margin-top: 2.5rem;
      margin-bottom: 1.5rem;
      padding-bottom: 0.5rem;
      border-bottom: 1px solid rgba(138, 99, 255, 0.3);
    }

    #learningStyleForm {
      background: var(--glass-effect);
      padding: 2.5rem;
      border-radius: var(--border-radius);
      box-shadow: var(--shadow);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border: 1px solid rgba(255, 255, 255, 0.05);
      position: relative;
      overflow: hidden;
    }

    #learningStyleForm:before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(77, 142, 255, 0.1) 0%, transparent 70%);
      opacity: 0;
      transition: var(--transition);
      z-index: -1;
    }

    #learningStyleForm:hover:before {
      opacity: 1;
    }

    .question-block {
      background: rgba(10, 10, 15, 0.3);
      margin-bottom: 1.5rem;
      padding: 1.5rem;
      border-radius: var(--border-radius);
      border-left: 4px solid var(--accent-purple);
      transition: var(--transition);
    }

    .question-block:hover {
      background: rgba(10, 10, 15, 0.5);
      transform: translateY(-3px);
      box-shadow: var(--shadow-hover);
    }

    .question-block p {
      font-weight: 500;
      margin-bottom: 1rem;
      color: var(--text-primary);
    }

    .answer-options {
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
    }

    label {
      display: flex;
      align-items: center;
      padding: 0.75rem 1rem;
      border-radius: 6px;
      background: rgba(20, 20, 30, 0.5);
      cursor: pointer;
      transition: var(--transition);
      position: relative;
      overflow: hidden;
    }

    label:hover {
      background: rgba(77, 142, 255, 0.1);
    }

    label:after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, rgba(77, 142, 255, 0.1), transparent);
      transform: translateX(-100%);
      transition: transform 0.3s ease;
    }

    label:hover:after {
      transform: translateX(0);
    }

    input[type="radio"] {
      appearance: none;
      -webkit-appearance: none;
      width: 18px;
      height: 18px;
      border: 2px solid var(--text-secondary);
      border-radius: 50%;
      margin-right: 1rem;
      position: relative;
      transition: var(--transition);
    }

    input[type="radio"]:checked {
      border-color: var(--accent-blue);
    }

    input[type="radio"]:checked:before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 10px;
      height: 10px;
      background: var(--accent-blue);
      border-radius: 50%;
    }

    button[type="submit"] {
      width: 100%;
      background: linear-gradient(135deg, var(--accent-blue), var(--accent-purple));
      color: white;
      border: none;
      padding: 1.1rem;
      border-radius: 8px;
      cursor: pointer;
      font-family: 'Inter', sans-serif;
      font-weight: 600;
      font-size: 1.05rem;
      transition: var(--transition);
      margin-top: 1.5rem;
      box-shadow: 0 4px 15px rgba(77, 142, 255, 0.3);
      position: relative;
      overflow: hidden;
    }

    button[type="submit"]:after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.2), transparent);
      transform: translateX(-100%);
      transition: transform 0.4s ease;
    }

    button[type="submit"]:hover:after {
      transform: translateX(0);
    }

    button[type="submit"]:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 25px rgba(77, 142, 255, 0.4);
    }

    button[type="submit"]:active {
      transform: translateY(1px);
    }

    #resultDisplay {
      background: var(--glass-effect);
      padding: 2rem;
      border-radius: var(--border-radius);
      margin-top: 2rem;
      box-shadow: var(--shadow);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border: 1px solid rgba(255, 255, 255, 0.05);
      text-align: center;
      font-size: 1.1rem;
      line-height: 1.7;
      display: none;
    }

    .result-highlight {
      color: var(--accent-cyan);
      font-weight: 600;
    }

    .scores {
      display: flex;
      justify-content: center;
      gap: 1.5rem;
      margin-top: 1rem;
      flex-wrap: wrap;
    }

    .score-item {
      background: rgba(10, 10, 15, 0.5);
      padding: 0.75rem 1.25rem;
      border-radius: 6px;
      font-size: 0.95rem;
    }

    .score-item span {
      color: var(--accent-blue);
      font-weight: 600;
    }

    @media (max-width: 768px) {
      body {
        padding: 1.5rem;
      }
      
      #learningStyleForm {
        padding: 1.5rem;
      }
      
      h1 {
        font-size: 2rem;
      }
      
      .logo {
        height: 50px;
      }
      
      .scores {
        flex-direction: column;
        gap: 0.75rem;
      }
    }

    .takeTest{
      display: none;
      position:fixed;
      top: 5%;
      right:5%;
      height: 90vh;
      width: 90vw;
      background: rgba(30, 30, 45, 0.805);
      z-index:1001;
      box-shadow: rgba(100, 100, 111, 0.2) 0px 7px 29px 0px,
                  rgba(50, 50, 93, 0.25) 0px 50px 100px -20px, 
                  rgba(0, 0, 0, 0.3) 0px 30px 60px -30px, 
                  rgba(10, 37, 64, 0.35) 0px -2px 6px 0px inset,
                  rgba(104, 46, 240, 0.4) 5px 5px, 
                  rgba(82, 46, 240, 0.3) 10px 10px, 
                  rgba(82, 46, 240, 0.2) 15px 15px, 
                  rgba(78, 46, 240, 0.1) 20px 20px, 
                  rgba(111, 46, 240, 0.05) 25px 25px;
      border-radius: 10px;
    }



  
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    #learningStyleForm {
      animation: fadeIn 0.6s ease-out forwards;
    }

    @keyframes logoPulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.15); }
    }

    .loader-logo {
        width: 80px;
        animation: logoPulse 1.6s ease-in-out infinite;
        filter: drop-shadow(0 0 14px rgba(129, 184, 192, 0.35));
    }

    #loader {
        position: fixed;
        inset: 0;
        z-index: 9999;
        display: flex;
        align-items: center;
        justify-content: center;
        backdrop-filter: blur(10px);
    }

    #loader.hide {
        animation: loaderFadeOut 0.6s ease forwards;
    }

    @keyframes loaderFadeOut {
        to { opacity: 0; pointer-events: none; }
    }

  
  </style>
</head>
<body>
  <div id="loader">
        <div class="loader-glass">
            <img src="/logo1.png" alt="Thinkr Logo" class="loader-logo" />
        </div>
    </div>
  <div class="takeTest"></div>
  <div class="container">
    <div class="logo-container">
      <a href = "/dashboard.html"><img src="/logo1.png" alt="Thinkr Logo" class="logo"></a>
    </div>
    
    <h1>Testul Stilurilor de Învățare</h1>
    <div id="displayType"></div>

    <form id="learningStyleForm">
      <div id="questionsContainer"></div>
      <button type="submit">Trimite Răspunsurile</button>
    </form>

    <div id="resultDisplay"></div>



  <script type="module">
    import { auth, db } from '/auth/firebase.js';
    import {onAuthStateChanged,signOut} from 'https://www.gstatic.com/firebasejs/10.12.1/firebase-auth.js';
    import {addDoc,collection, query, getDocs, where } from 'https://www.gstatic.com/firebasejs/10.12.1/firebase-firestore.js';

    let currentUser = null;

    onAuthStateChanged(auth, async (user) => {
      if (!user) return window.location.href = '/auth/login.html';
      currentUser = user;
      await testStudying();
      hideLoader();
    });

    

    async function completedOrNot(){
      const formQuery = query(
        collection(db, "testResults"),
        where("userId", "==", currentUser.uid)
      );

      const snapshot = await getDocs(formQuery);

      return !snapshot.empty;

    }

    async function testStudying(){
      const completed = await completedOrNot();

      if(!completed){
        const learningTests = {
              Vizual: [
                {
                  question: "Prefer să văd informațiile scrise pe tablă și să fie completate de materiale vizuale și lecturi atribuite.",
                  answers: [
                    { text: "Des", score: 5 },
                    { text: "Cateodata", score: 3 },
                    { text: "Niciodată", score: 1 }
                  ]
                },
                {
                  question: "Îmi place să notez sau să iau notițe pentru revizuire vizuală.",
                  answers: [
                    { text: "Des", score: 5 },
                    { text: "Cateodata", score: 3 },
                    { text: "Niciodată", score: 1 }
                  ]
                },
                {
                  question: "Mă descurc și îmi place să creez grafice și diagrame.",
                  answers: [
                    { text: "Des", score: 5 },
                    { text: "Cateodata", score: 3 },
                    { text: "Niciodată", score: 1 }
                  ]
                },
                {
                  question: "Înțeleg ușor și urmez cu succes indicațiile de pe o hartă.",
                  answers: [
                    { text: "Des", score: 5 },
                    { text: "Cateodata", score: 3 },
                    { text: "Niciodată", score: 1 }
                  ]
                },
                {
                  question: "Înțeleg mai bine un articol de știri citind despre el într-un ziar decât ascultând un raport la radio.",
                  answers: [
                    { text: "Des", score: 5 },
                    { text: "Cateodata", score: 3 },
                    { text: "Niciodată", score: 1 }
                  ]
                },
                {
                  question: "Cred că cel mai bun mod de a-ți aminti ceva este să îți imaginezi acea informație în mintea ta.",
                  answers: [
                    { text: "Des", score: 5 },
                    { text: "Cateodata", score: 3 },
                    { text: "Niciodată", score: 1 }
                  ]
                },
                {
                  question: "Sunt priceput în rezolvarea puzzle-urilor și labirinturilor.",
                  answers: [
                    { text: "Des", score: 5 },
                    { text: "Cateodata", score: 3 },
                    { text: "Niciodată", score: 1 }
                  ]
                },
                {
                  question: "Prefer să obțin informații despre un subiect interesant citind despre el.",
                  answers: [
                    { text: "Des", score: 5 },
                    { text: "Cateodata", score: 3 },
                    { text: "Niciodată", score: 1 }
                  ]
                }
              ],

              Auditiv: [
                {
                  question: "Prefer să ascult explicații sau prelegeri pentru a înțelege mai bine materialul.",
                  answers: [
                    { text: "Des", score: 5 },
                    { text: "Cateodata", score: 3 },
                    { text: "Niciodată", score: 1 }
                  ]
                },
                {
                  question: "Îmi place să învăț prin discuții sau dezbateri cu alții.",
                  answers: [
                    { text: "Des", score: 5 },
                    { text: "Cateodata", score: 3 },
                    { text: "Niciodată", score: 1 }
                  ]
                },
                {
                  question: "Rețin mai ușor informațiile atunci când le aud, nu când le citesc.",
                  answers: [
                    { text: "Des", score: 5 },
                    { text: "Cateodata", score: 3 },
                    { text: "Niciodată", score: 1 }
                  ]
                },
                {
                  question: "Îmi place să folosesc înregistrări audio sau podcasturi pentru a învăța.",
                  answers: [
                    { text: "Des", score: 5 },
                    { text: "Cateodata", score: 3 },
                    { text: "Niciodată", score: 1 }
                  ]
                },
                {
                  question: "Îmi place să repet cu voce tare ceea ce trebuie să învăț.",
                  answers: [
                    { text: "Des", score: 5 },
                    { text: "Cateodata", score: 3 },
                    { text: "Niciodată", score: 1 }
                  ]
                },
                {
                  question: "Ascult cu atenție tonul și inflexiunile atunci când cineva vorbește.",
                  answers: [
                    { text: "Des", score: 5 },
                    { text: "Cateodata", score: 3 },
                    { text: "Niciodată", score: 1 }
                  ]
                },
                {
                  question: "Prefer să primesc instrucțiuni orale în locul celor scrise.",
                  answers: [
                    { text: "Des", score: 5 },
                    { text: "Cateodata", score: 3 },
                    { text: "Niciodată", score: 1 }
                  ]
                },
                {
                  question: "Mă concentrez mai bine când învăț cu muzică de fundal sau sunete ambientale.",
                  answers: [
                    { text: "Des", score: 5 },
                    { text: "Cateodata", score: 3 },
                    { text: "Niciodată", score: 1 }
                  ]
                }
              ],

              Tactil: [
                {
                  question: "Prefer să folosesc postere, modele sau practică efectivă și alte activități în clasă.",
                  answers: [
                    { text: "Des", score: 5 },
                    { text: "Cateodata", score: 3 },
                    { text: "Niciodată", score: 1 }
                  ]
                },
                {
                  question: "Îmi place să lucrez cu mâinile sau să fac lucruri.",
                  answers: [
                    { text: "Des", score: 5 },
                    { text: "Cateodata", score: 3 },
                    { text: "Niciodată", score: 1 }
                  ]
                },
                {
                  question: "Îmi amintesc cel mai bine scriind lucrurile.",
                  answers: [
                    { text: "Des", score: 5 },
                    { text: "Cateodata", score: 3 },
                    { text: "Niciodată", score: 1 }
                  ]
                },
                {
                  question: "Mă joc cu monede sau chei în buzunar.",
                  answers: [
                    { text: "Des", score: 5 },
                    { text: "Cateodata", score: 3 },
                    { text: "Niciodată", score: 1 }
                  ]
                },
                {
                  question: "Mestec gumă, fumez sau iau gustări în timp ce studiez.",
                  answers: [
                    { text: "Des", score: 5 },
                    { text: "Cateodata", score: 3 },
                    { text: "Niciodată", score: 1 }
                  ]
                },
                {
                  question: "Învăț ortografia cuvintelor „scriindu-le cu degetele” în aer.",
                  answers: [
                    { text: "Des", score: 5 },
                    { text: "Cateodata", score: 3 },
                    { text: "Niciodată", score: 1 }
                  ]
                },
                {
                  question: "Țin obiecte în mâini în timpul perioadelor de învățare.",
                  answers: [
                    { text: "Des", score: 5 },
                    { text: "Cateodata", score: 3 },
                    { text: "Niciodată", score: 1 }
                  ]
                },
                {
                  question: "Nu am o problemă când vine vorba de contactul fizic cu alte persoane.",
                  answers: [
                    { text: "Des", score: 5 },
                    { text: "Cateodata", score: 3 },
                    { text: "Niciodată", score: 1 }
                  ]
                }
              ]
            };


          const container = document.getElementById('questionsContainer');
          const form = document.getElementById('learningStyleForm');
          const resultDisplay = document.getElementById('resultDisplay');

          Object.entries(learningTests).forEach(([type, questions]) => {
            const header = document.createElement('h2');
            header.textContent = `Stil ${type}`;
            container.appendChild(header);

            questions.forEach((q, qIndex) => {
              const block = document.createElement('div');
              block.className = 'question-block';

              const title = document.createElement('p');
              title.textContent = `${qIndex + 1}. ${q.question}`;
              block.appendChild(title);

              const options = document.createElement('div');
              options.className = 'answer-options';

              q.answers.forEach((a) => {
                const label = document.createElement('label');
                const input = document.createElement('input');
                input.type = 'radio';
                input.name = `${type}-q${qIndex}`;
                input.value = a.score;
                input.required = true;

                label.appendChild(input);
                label.appendChild(document.createTextNode(a.text));
                options.appendChild(label);
              });

              block.appendChild(options);
              container.appendChild(block);
            });
          });

          form.addEventListener('submit', async (e) => {
            e.preventDefault();
            const results = { Vizual: 0, Auditiv: 0, Tactil: 0 };

            Object.entries(learningTests).forEach(([type, questions]) => {
              questions.forEach((_, qIndex) => {
                const selected = document.querySelector(
                  `input[name='${type}-q${qIndex}']:checked`
                );
                if (selected) results[type] += parseInt(selected.value);
              });
            });

            const max = Math.max(...Object.values(results));
            const dominant = Object.keys(results).find((key) => results[key] === max);

            resultDisplay.innerHTML = `
              <p>Stilul tău dominant de învățare este: <span class="result-highlight">${dominant}</span></p>
              <div class="scores">
                <div class="score-item">Vizual: <span>${results.Vizual}</span></div>
                <div class="score-item">Auditiv: <span>${results.Auditiv}</span></div>
                <div class="score-item">Tactil: <span>${results.Tactil}</span></div>
              </div>
              <p style="margin-top: 1.5rem;">Rezultatele au fost salvate în contul tău.</p>
            `;
            resultDisplay.style.display = 'block';

            try {
              await addDoc(collection(db, 'testResults'), {
                userId: currentUser.uid,
                timestamp: new Date().toISOString(),
                results
              });
            } catch (error) {
              console.error('Eroare salvare Firebase:', error);
              resultDisplay.querySelector('p:last-child').textContent = 
                'A apărut o eroare la salvarea rezultatelor.';
            }
          });
            }else{
            document.getElementById("learningStyleForm").display="none";
            const formQuery = query(
                collection(db, "testResults"),
                where("userId", "==", currentUser.uid)
              );

              const snapshot = await getDocs(formQuery);
              const data = snapshot.docs[0].data();
              const displayResults = document.getElementById("displayType");
              const max = Math.max(...Object.values(data.results));
              const dominant = Object.keys(data.results).find((key) => data.results[key] === max);
              displayResults.innerHTML = `
              <p>Stilul tău dominant de învățare este: <span class="result-highlight">${dominant}</span></p>
              <div class="scores">
                <div class="score-item">Vizual: <span>${data.results.Vizual}</span></div>
                <div class="score-item">Auditiv: <span>${data.results.Auditiv}</span></div>
                <div class="score-item">Tactil: <span>${data.results.Tactil}</span></div>
              </div>
              <p style="margin-top: 1.5rem;">Rezultatele au fost salvate în contul tău.</p>
            `;
            }

          }


          function takeTest(title){

            alert(`Testul ${title} este acum oe ecran `);
          }

          function hideLoader() {
            const loader = document.getElementById("loader");
            if (!loader) return;

            loader.classList.add("hide");

            setTimeout(() => {
              loader.remove();
            }, 600);
          }
    
  </script>
</body>
</html>
